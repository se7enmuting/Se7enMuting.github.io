---
layout: post
title: "ðŸ’»ç¾¤æ™–DSM6.1ä½¿ç”¨acme.shå®‰è£…å¹¶è‡ªåŠ¨æ›´æ–°Let'så…è´¹è¯ä¹¦"
subtitle: ""
author: "Se7enMuting"
header-img: "img/posts/180823/post-bg.png"
header-mask: 0.4
tags:
  - æŠ€æœ¯
  - Synology
---

Chinamainland å®¶å®½çš„80/443ç«¯å£æ˜¯ä¸å¼€æ”¾çš„ï¼Œæ‰€ä»¥ç¾¤æ™–è‡ªå¸¦çš„è¯ä¹¦æ›´æ–°æ— æ³•ä½¿ç”¨ï¼Œä¸‹é¢ä»‹ç»ç”¨acme.shçš„æ–¹æ³•ã€‚æ­¤æ–‡ç« åœ¨é»‘ç¾¤æ™–6.1.7ä¸Šæµ‹è¯•æˆåŠŸã€‚

å…ˆSSHè¿›ç³»ç»Ÿ

#### 1.å®‰è£…acme.sh

å…ˆåœ¨ `volume5` ä¸‹æ–°å»ºæ–‡ä»¶å¤¹`@acme`ï¼Œç„¶åŽä¸‹é¢å‘½ä»¤å®‰è£…ï¼š

```
wget https://github.com/Neilpang/acme.sh/archive/master.tar.gz
tar xvf master.tar.gz
cd acme.sh-master/
./acme.sh â€“install â€“nocron â€“home /volume5/@acme/acme.sh/
```

#### 2.ç”¨dnspod APIç”ŸæˆLetâ€™sè¯ä¹¦

æ³¨æ„ï¼šä¸è¦ç”¨eccè¯ä¹¦ï¼Œé‡å¯è¯ä¹¦ä¼šå¤±æ•ˆï¼ŒFTPSä¹Ÿä¸æ”¯æŒã€‚

å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š
```
export DP_Id="xxxxx"
export DP_Key="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
/volume5/@acme/acme.sh/acme.sh â€“home "/volume5/@acme" â€“issue â€“dns dns_dp -d demo.com â€“dnssleep 30
```

åˆ°æ­¤ï¼ŒåŽ»ç¾¤æ™–çš„webé‡Œï¼ŒæŽ§åˆ¶é¢æ¿-å®‰å…¨æ€§-è¯ä¹¦é‡Œï¼ŒæŠŠé»˜è®¤çš„è¯ä¹¦å…ˆæ›¿æ¢æˆacme.shç”Ÿæˆçš„è¯ä¹¦ï¼ˆ/`volume5`/`@acme`/`demo.com`å†…ï¼‰ï¼Œè§ä¸‹å›¾ï¼Œä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢é…ç½®ä¿¡æ¯ä¸¢å¤±ã€‚

![img01](/img/posts/180823/01.png)

çŽ°åœ¨è¯ä¹¦å·²ç»è£…å¥½äº†ï¼Œæ¯æ¬¡å®‰æŒ‰ç…§ä¸Šé¢çš„æ–¹å¼æ‰‹åŠ¨æ›´æ–°è¯ä¹¦ä¹Ÿå¯ä»¥ã€‚

#### 3.å…¨è‡ªåŠ¨æ›´æ–°è¯ä¹¦

è¾“å…¥ä¸‹é¢ä¸€æ¡å‘½ä»¤ï¼ˆ`g3i0CB`æ˜¯é»˜è®¤è¯ä¹¦æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œå’ŒDEFAULTæ–‡ä»¶é‡Œå†…å®¹ä¸€è‡´ï¼Œè‡ªè¡Œä¿®æ”¹ã€‚INFOæ–‡ä»¶æ˜¯é…ç½®ä¿¡æ¯ï¼Œä¸è¦ä¹±æ”¹ã€‚`demo.com`æ˜¯ä½ è‡ªå·±çš„åŸŸåï¼‰ï¼š

```
/volume5/@acme/acme.sh/acme.sh â€“home "/volume5/@acme" â€“install-cert -d demo.com â€“fullchain-file /usr/syno/etc/certificate/_archive/g3i0CB/fullchain.pem â€“key-file /usr/syno/etc/certificate/_archive/g3i0CB/privkey.pem â€“cert-file /usr/syno/etc/certificate/_archive/g3i0CB/cert.pem â€“ca-file /usr/syno/etc/certificate/_archive/g3i0CB/chain.pem â€“reloadcmd "rsync -avzh /usr/syno/etc/certificate/_archive/g3i0CB/ /usr/syno/etc/certificate/system/default/ && rsync -avzh /usr/syno/etc/certificate/_archive/g3i0CB/ /usr/syno/etc/certificate/smbftpd/ftpd && /usr/syno/etc/rc.sysv/nginx.sh reload"
```

å»ºä¸ª.shè„šæœ¬ï¼Œæ·»åŠ åˆ°è®¡åˆ’ä»»åŠ¡é‡Œï¼Œæ¯å¤©è‡ªåŠ¨è¿è¡Œä¸€æ¬¡ï¼š

```
/volume5/@myshell/acme_update.sh >> /volume5/@myshell/log.txt 2>&1
```

acme_update.shè„šæœ¬å†…å®¹ï¼š

```
/volume5/@acme/acme.sh/acme.sh â€“home "/volume5/@acme" â€“renew â€“dns dns_dp -d demo.com
```
